<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="utf-8" />
  <title>Doctor Signup Request</title>
  <link rel="stylesheet" th:href="@{/css/style.css}" />

  <style>
    /* Page-scoped signup styles - cohesive with project theme */
    html,
    body {
      height: 100%;
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(180deg, #f7fbff 0%, #fbfbfe 100%);
      color: #0b2142;
    }

    h2 {
      text-align: center;
      color: #06203a;
      margin-top: 28px;
      margin-bottom: 8px;
      font-size: 1.6rem;
      font-weight: 700;
      letter-spacing: 0.2px;
    }

    .note {
      max-width: 980px;
      margin: 12px auto;
      background: linear-gradient(180deg, #fffaf0, #fff7e6);
      padding: 12px 16px;
      border-radius: 10px;
      border: 1px solid #ffecd1;
      color: #6b4b00;
      box-shadow: 0 8px 30px rgba(230, 180, 80, 0.06);
    }

    .form {
      max-width: 980px;
      margin: 18px auto 48px;
      padding: 22px;
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.98), rgba(250, 251, 255, 0.95));
      box-shadow: 0 24px 70px rgba(6, 32, 68, 0.08);
      border: 1px solid rgba(10, 24, 48, 0.04);
    }

    /* Grid layout for form fields */
    .row {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 14px 20px;
      align-items: start;
    }

    /* two-column layout: main fields + right sidebar */
    .form-grid {
      display: grid;
      grid-template-columns: 1fr 340px;
      gap: 20px;
      align-items: start;
    }

    .form-side {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .side-card {
      background: #fff;
      border-radius: 12px;
      padding: 14px;
      border: 1px solid rgba(16, 24, 64, 0.04);
      box-shadow: 0 8px 30px rgba(6, 32, 68, 0.04);
    }

    .side-card h4 {
      margin: 0 0 6px 0;
      font-size: 1.05rem;
      color: #06203a;
    }

    .side-card .muted {
      color: #6b7280;
      font-size: 0.95rem;
      margin: 0 0 8px 0;
    }

    .preview-wrap {
      margin-top: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .certificate-info {
      margin-top: 8px;
      font-size: 0.95rem;
      color: #334155;
    }

    /* Add subtle header divider */
    .form .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-bottom: 10px;
    }

    .muted-small {
      color: #6b7280;
      font-size: 0.95rem;
    }

    .row .full {
      grid-column: 1 / -1;
    }

    .row>div {
      display: flex;
      flex-direction: column;
    }

    label {
      font-weight: 600;
      color: #213547;
      margin-bottom: 6px;
    }

    input[type="text"],
    input[type="email"],
    input[type="password"],
    input[type="date"],
    input[type="number"],
    textarea {
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid rgba(16, 24, 64, 0.08);
      background: #fff;
      font-size: 14px;
      color: #042033;
      transition: box-shadow .12s, border-color .12s;
    }

    /* explicit class for form-like inputs (applied to BMDC field) */
    .form-input {
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid rgba(16, 24, 64, 0.08);
      background: #fff;
      font-size: 14px;
      color: #042033;
      transition: box-shadow .12s, border-color .12s;
    }

    input:focus,
    textarea:focus {
      outline: none;
      border-color: #4EA685;
      box-shadow: 0 10px 30px rgba(78, 166, 133, 0.08);
    }

    /* File input styling ‚Äî keep default but add spacing */
    input[type="file"] {
      padding: 8px 6px;
    }

    /* Preview image styling */
    #previewImage {
      width: 140px;
      height: 140px;
      border-radius: 12px;
      margin-top: 8px;
      object-fit: cover;
      border: 1px solid rgba(16, 24, 64, 0.06);
      box-shadow: 0 8px 30px rgba(6, 32, 68, 0.06);
    }

    /* Actions */
    .actions {
      margin-top: 18px;
      display: flex;
      gap: 12px;
      justify-content: flex-end;
    }

    .btn {
      padding: 10px 16px;
      border-radius: 10px;
      font-weight: 700;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
    }

    .btn.save {
      background: linear-gradient(90deg, #1d8cf8 0%, #4EA685 100%);
      color: #fff;
      border: none;
      box-shadow: 0 12px 36px rgba(29, 140, 248, 0.12);
    }

    .btn.cancel {
      background: transparent;
      color: #1d8cf8;
      border: 1px solid rgba(29, 140, 248, 0.12);
    }

    /* Small input file tweaks */
    .file-row {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .file-row input[type="file"] {
      border-radius: 8px;
    }

    /* Responsive: single column on small screens */
    @media (max-width:900px) {
      .row {
        grid-template-columns: 1fr;
      }

      .actions {
        justify-content: center;
      }
      .strength-weak { background:red; }
.strength-medium { background:orange; }
.strength-strong { background:green; }
    }
  </style>
</head>

<body>

  <h2>Doctor Signup Request</h2>

  <div class="note">
    After submitting, your information will be reviewed.
    You will receive an approval email when your account is activated.
  </div>

  <div class="form">
    <form th:action="@{/doctor/signup/request}" method="post" enctype="multipart/form-data">

      <div class="form-grid">
        <div class="row-left">

          <!-- Profile preview shown at the top for better UX -->
          <div class="full"
            style="display:flex; flex-direction:column; align-items:center; gap:8px; margin-bottom:12px;">
            <label style="font-weight:700;">Profile Photo</label>
            <img id="previewImage" src="/image/profile.jpg" alt="Profile preview"
              style="width:140px;height:140px;border-radius:12px;object-fit:cover;border:1px solid rgba(16,24,64,0.06);box-shadow:0 8px 30px rgba(6,32,68,0.06);" />
            <input type="file" id="profileImageFile" name="profileImageFile" accept="image/*" style="margin-top:8px;" />
          </div>

          <div class="row">

            <!-- Full Name -->
            <div>
              <label>Full Name *</label>
              <input type="text" name="name" th:value="${doctor.name}" required />
            </div>

            <!-- Profile Image input has been moved to the sidebar for better layout -->

            <!-- Gender -->
            <div>
              <label>Gender *</label>
              <select name="gender" required>
                <option th:selected="${doctor.gender == null}" disabled>Select Gender</option>
                <option value="Male" th:selected="${doctor.gender == 'Male'}">Male</option>
                <option value="Female" th:selected="${doctor.gender == 'Female'}">Female</option>
                <option value="Other" th:selected="${doctor.gender == 'Other'}">Other</option>
              </select>
            </div>
            <!-- DOB -->
            <div>
              <label>Date of Birth *</label>
              <input type="date" name="dob" th:value="${doctor.dob}" required />
            </div>

            <!-- Blood Group -->
            <div>
              <label>Blood Group *</label>
              <select name="bloodGroup" required>
                <option th:selected="${doctor.bloodGroup == null}" disabled>Select Blood Group</option>
                <option value="A+" th:selected="${doctor.bloodGroup == 'A+'}">A+</option>
                <option value="A-" th:selected="${doctor.bloodGroup == 'A-'}">A-</option>
                <option value="B+" th:selected="${doctor.bloodGroup == 'B+'}">B+</option>
                <option value="B-" th:selected="${doctor.bloodGroup == 'B-'}">B-</option>
                <option value="AB+" th:selected="${doctor.bloodGroup == 'AB+'}">AB+</option>
                <option value="AB-" th:selected="${doctor.bloodGroup == 'AB-'}">AB-</option>
                <option value="O+" th:selected="${doctor.bloodGroup == 'O+'}">O+</option>
                <option value="O-" th:selected="${doctor.bloodGroup == 'O-'}">O-</option>
              </select>
            </div>


            <!-- Email -->
            <div>
  <label>Email *</label>
  <input type="email" id="email" name="email" required />
  <div id="emailError" style="color:#9b1c1c; font-weight:600; margin-top:6px;"></div>
</div>

  <div>
  <label>Password *</label>
  <div style="position:relative;">
    <input type="password" id="password" name="password" required style="width:100%; padding-right:40px;">
    <span id="togglePassword" style="position:absolute; right:10px; top:50%; transform:translateY(-50%); cursor:pointer;">üëÅÔ∏è</span>
  </div>
  <div id="passwordStrength" style="height:6px; width:100%; border-radius:4px; margin-top:6px; background:#eee;"></div>
  <div id="passwordError" style="color:#9b1c1c; margin-top:4px; font-weight:600;"></div>
</div>

<div>
  <label>Confirm Password *</label>
  <input type="password" id="confirmPassword" name="confirmPassword" required style="width:100%;">
  <div id="confirmPasswordError" style="color:#9b1c1c; margin-top:4px; font-weight:600;"></div>
</div>




            <!-- Phone Number -->
            <div>
              <label>Phone Number *</label>
              <input type="text" name="phoneNumber" th:value="${doctor.phoneNumber}" maxlength="11" pattern="\d{11}"
                title="Phone must be 11 digits" required />
            </div>

            <!-- Alternate Phone -->
            <div>
              <label>Alternate Phone</label>
              <input type="text" name="altPhone" th:value="${doctor.altPhone}" maxlength="11" pattern="\d{11}"
                title="Phone must be 11 digits" />
            </div>

            <!-- Emergency Contact -->
            <div>
              <label>Emergency Contact *</label>
              <input type="text" name="emergencyContact" th:value="${doctor.emergencyContact}" maxlength="11"
                pattern="\d{11}" title="Emergency contact must be 11 digits" required />
            </div>



            <!-- Address Block -->
            <div class="full"><label>Address *</label></div>

            <!-- Division -->
            <div>
              <label>Division *</label>
              <select name="division" required>
                <option th:selected="${doctor.division == null}" disabled>Select Division</option>
                <option value="Dhaka" th:selected="${doctor.division == 'Dhaka'}">Dhaka</option>
                <option value="Chattogram" th:selected="${doctor.division == 'Chattogram'}">Chattogram</option>
                <option value="Khulna" th:selected="${doctor.division == 'Khulna'}">Khulna</option>
                <option value="Barishal" th:selected="${doctor.division == 'Barishal'}">Barishal</option>
                <option value="Sylhet" th:selected="${doctor.division == 'Sylhet'}">Sylhet</option>
                <option value="Rajshahi" th:selected="${doctor.division == 'Rajshahi'}">Rajshahi</option>
                <option value="Rangpur" th:selected="${doctor.division == 'Rangpur'}">Rangpur</option>
                <option value="Mymensingh" th:selected="${doctor.division == 'Mymensingh'}">Mymensingh</option>
              </select>
            </div>

            <!-- Zilla/District -->
            <div>
              <label>Zilla *</label>
              <select name="zilla" required>
                <option th:selected="${doctor.zilla == null}" disabled>Select Zilla</option>
                <option value="Dhaka" th:selected="${doctor.zilla == 'Dhaka'}">Dhaka</option>
                <option value="Gazipur" th:selected="${doctor.zilla == 'Gazipur'}">Gazipur</option>
                <option value="Chattogram" th:selected="${doctor.zilla == 'Chattogram'}">Chattogram</option>
                <option value="Khulna" th:selected="${doctor.zilla == 'Khulna'}">Khulna</option>
                <!-- Add more districts as needed -->
              </select>
            </div>

            <div>
              <label>Street *</label>
              <input type="text" name="street" th:value="${doctor.street}" required />
            </div>

            <div>
              <label>Postal Code *</label>
              <input type="text" name="postalCode" th:value="${doctor.postalCode}" required />
            </div>



            <!-- Professional Information -->
            <div class="full"><label>Professional Information *</label></div>

            <div>
              <label>Degrees *</label>
              <input type="text" name="degrees" th:value="${doctor.degrees}" required />
            </div>

            <div>
              <label>BMDC Registration No.</label>
              <input class="form-input" type="text" name="bmdcRegNo" th:value="${doctor.bmdcRegNo}"
                placeholder="e.g. A-123456" pattern="^[A-Za-z]-\d{6}$"
                title="Format: A-123456 (single letter, dash, 6 digits)" />
              <div id="bmdcHint" class="muted-small">Format example: <strong>A-123456</strong></div>
              <div id="bmdcError" style="color:#9b1c1c; display:none; margin-top:6px; font-weight:600;">Please enter a
                valid BMDC number (e.g. A-123456)</div>
            </div>

            <div>
              <label>Specialization *</label>
              <input type="text" name="specialization" th:value="${doctor.specialization}" required />
            </div>

            <div>
              <label>Specialities</label>
              <input type="text" name="specialities" th:value="${doctor.specialities}" />
            </div>

            <div>
              <label>Education *</label>
              <input type="text" name="education" th:value="${doctor.education}" required />
            </div>

            <div>
              <label>Experience (Years) *</label>
              <input type="number" name="experienceYears" th:value="${doctor.experienceYears}" required />
            </div>



            <div>
              <label>Languages *</label>
              <input type="text" name="languages" th:value="${doctor.languages}" required />
            </div>

            <div>
              <label>Hospital Name *</label>
              <input type="text" name="hospitalName" th:value="${doctor.hospitalName}" required />
            </div>

            <div class="full">
              <label>Hospital Address *</label>
              <input type="text" name="hospitalAddress" th:value="${doctor.hospitalAddress}" required />
            </div>

            <div>
              <label>Medical College *</label>
              <input type="text" name="medicalCollege" th:value="${doctor.medicalCollege}" required />
            </div>

          </div>

          <div style="margin-top:12px;">
            <label>Certificate (PDF)</label>
            <div class="file-row">
              <input type="file" id="certificateFile" name="certificateFile" accept="application/pdf" />
              <div id="certificateInfo" class="certificate-info muted-small">No file selected</div>
            </div>
          </div>

          <div class="actions">
            <button type="submit" class="btn save">Submit Request</button>
            <a href="/" class="btn cancel">Cancel</a>
          </div>
    </form>
  </div>

<script>
(function() {
  // ===== Elements =====
  const profileInput = document.getElementById('profileImageFile');
  const preview = document.getElementById('previewImage');
  const certInput = document.getElementById('certificateFile');
  const certInfo = document.getElementById('certificateInfo');
  const bmdcInput = document.querySelector('input[name="bmdcRegNo"]');
  const bmdcError = document.getElementById('bmdcError');

  
  // ===== BMDC Validation =====
  const bmdcPattern = /^[A-Za-z]-\d{6}$/;
  if (bmdcInput) {
    bmdcInput.addEventListener('input', () => {
      if (!bmdcInput.value) {
        bmdcError.style.display = 'none';
        return;
      }
      bmdcError.style.display = bmdcPattern.test(bmdcInput.value) ? 'none' : 'block';
    });
  }

  // ===== Profile Image Preview =====
  if (profileInput && preview) {
    profileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) return;

      const allowedTypes = ['image/jpeg', 'image/png', 'image/jpg', 'image/gif'];
      const ext = file.name.split('.').pop().toLowerCase();

      if (!allowedTypes.includes(file.type) && !['jpg', 'jpeg', 'png', 'gif'].includes(ext)) {
        alert('Please select a valid image file (jpg, jpeg, png, gif)');
        profileInput.value = '';
        preview.src = '/image/profile.jpg'; // reset to default
        return;
      }

      const reader = new FileReader();
      reader.onload = (ev) => { preview.src = ev.target.result; };
      reader.readAsDataURL(file);
    });
  }

  // ===== Certificate File Info =====
  if (certInput && certInfo) {
    certInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) {
        certInfo.textContent = 'No file selected';
        return;
      }
      if (file.type !== 'application/pdf') {
        alert('Please select a PDF file');
        certInput.value = '';
        certInfo.textContent = 'No file selected';
        return;
      }
      const sizeMB = (file.size / (1024 * 1024)).toFixed(2);
      certInfo.textContent = `${file.name} ‚Äî ${sizeMB} MB`;
    });
  }
const password = document.getElementById('password');
const confirmPassword = document.getElementById('confirmPassword');
const strengthBar = document.getElementById('passwordStrength');
const togglePassword = document.getElementById('togglePassword');
const passwordError = document.getElementById('passwordError');
const confirmError = document.getElementById('confirmPasswordError');

// Regex for validation
const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&^#.,;:(){}[\]<>~]).{8,}$/;

// Compute strength based on points
function getPasswordStrength(pwd) {
  let score = 0;
  if (pwd.length >= 8) score++;
  if (/[a-z]/.test(pwd)) score++;
  if (/[A-Z]/.test(pwd)) score++;
  if (/\d/.test(pwd)) score++;
  if (/[@$!%*?&^#.,;:(){}[\]<>~]/.test(pwd)) score++;

  if (score <= 2) return 'weak';
  if (score === 3 || score === 4) return 'medium';
  if (score === 5) return 'strong';
}

// Update strength bar visually
function updateStrengthBar(pwd) {
  const strength = getPasswordStrength(pwd);
  if (strength === 'weak') {
    strengthBar.style.background = 'red';
    strengthBar.style.width = '33%';
  } else if (strength === 'medium') {
    strengthBar.style.background = 'orange';
    strengthBar.style.width = '66%';
  } else if (strength === 'strong') {
    strengthBar.style.background = 'green';
    strengthBar.style.width = '100%';
  } else {
    strengthBar.style.background = '#eee';
    strengthBar.style.width = '0%';
  }
}

// Password input event
password.addEventListener('input', () => {
  const val = password.value;
  updateStrengthBar(val);

  if (!regex.test(val)) {
    passwordError.textContent = "Password must have uppercase, lowercase, number, special char & 8+ chars";
  } else {
    passwordError.textContent = "";
  }

  // Confirm password live check
  if (confirmPassword.value && confirmPassword.value !== val) {
    confirmError.textContent = "Passwords do not match!";
  } else {
    confirmError.textContent = "";
  }
});

// Confirm password input
confirmPassword.addEventListener('input', () => {
  if (confirmPassword.value !== password.value) {
    confirmError.textContent = "Passwords do not match!";
  } else {
    confirmError.textContent = "";
  }
});

// Show/hide toggle
togglePassword.addEventListener('click', () => {
  password.type = password.type === "password" ? "text" : "password";
  togglePassword.textContent = password.type === "password" ? "üëÅÔ∏è" : "üôà";
});
  //Submission Check =====
  const form = document.querySelector('form');
  if (form) {
    form.addEventListener('submit', (ev) => {
      if (bmdcInput && bmdcInput.value && !bmdcPattern.test(bmdcInput.value)) {
        ev.preventDefault();
        bmdcError.style.display = 'block';
        bmdcInput.focus();
        return;
      }
      if (!regex.test(passwordInput.value)) {
        ev.preventDefault();
        passwordError.textContent = 'Password is not strong enough';
        passwordInput.focus();
        return;
      }
      if (passwordInput.value !== confirmPasswordInput.value) {
        ev.preventDefault();
        confirmPasswordError.textContent = 'Passwords do not match';
        confirmPasswordInput.focus();
        return;
      }
    });
  }

})();
const emailInput = document.getElementById('email');
  const emailError = document.getElementById('emailError');

  // Regex for email validation
  const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

  emailInput.addEventListener('input', () => {
    const value = emailInput.value;

    if (!emailRegex.test(value)) {
      emailError.textContent = 'Please enter a valid email address';
    } else {
      emailError.textContent = '';
    }
  });
</script>
      
      

</body>

</html>