<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Today's Tasks | CloudCare</title>
  <link rel="stylesheet" th:href="@{/css/style.css}">
  <link rel="stylesheet" th:href="@{/css/style-todo.css}">
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
  <style>
    @media print {
      body { background:white; padding:20px; }
      .no-print { display:none; }
    }
  </style>
</head>
<body style="background:linear-gradient(180deg,#f8fbff,#ffffff);min-height:100vh;">

<div style="padding:32px;max-width:1100px;margin:0 auto;">
  <header style="display:flex;justify-content:space-between;align-items:center;margin-bottom:28px;flex-wrap:wrap;gap:16px;">
    <div>
      <h1 style="font-size:2.6rem;color:#040d72;font-weight:700;margin:0;">Today's Tasks</h1>
      <div style="color:#666;margin-top:8px;" th:text="'Date: ' + ${#temporals.format(today,'EEEE, MMMM dd, yyyy')}">Date</div>
    </div>
    <div class="no-print" style="display:flex;gap:12px;">
      <a href="#" onclick="window.print();return false;" class="btn btn-outline">Print</a>
      <button onclick="window.close()" class="btn btn-primary">Close Window</button>
    </div>
  </header>

  <div style="display:flex;gap:20px;margin-bottom:32px;flex-wrap:wrap;">
    <div class="stat-card" style="flex:1;min-width:200px;text-align:center;">
      <div style="font-size:2.4rem;font-weight:700;color:#22c55e;" th:text="${dailyRate} + '%'">0%</div>
      <div class="stat-label">Daily Completion Rate</div>
    </div>
    <div class="stat-card" style="flex:1;min-width:200px;text-align:center;">
      <div style="font-size:2.4rem;font-weight:700;color:#040d72;" th:text="${weeklyRate} + '%'">0%</div>
      <div class="stat-label">Weekly Average (Last 7 Days)</div>
    </div>
  </div>

  <div class="table-container">
    <table class="table" style="min-width:800px;">
      <thead>
        <tr>
          <th style="width:80px;">Complete</th>
          <th>Task</th>
          <th>Category</th>
          <th>Priority</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr th:each="task : ${todayTasks}">
          <td style="text-align:center;">
            <a th:href="@{/patient/tasks/complete/{id}(id=${task.id})}">
              <i th:class="${task.completed} ? 'bx bxs-check-square' : 'bx bx-square'" 
                 style="font-size:22px;color:#22c55e;"></i>
            </a>
          </td>
          <td th:text="${task.title}">Task Title</td>
          <td th:text="${task.category}">General</td>
          <td th:text="${task.priority == 'High' ? 'High' : (task.priority == 'Medium' ? 'Medium' : 'Low')}">Medium</td>
          <td>
            <span th:class="${task.completed} ? 'badge completed' : (task.status=='In Progress' ? 'badge inprogress' : 'badge pending')"
                  th:text="${task.completed ? 'Completed' : (task.status=='In Progress' ? 'In Progress' : 'Pending')}">
              Pending
            </span>
          </td>
        </tr>
        <tr th:if="${#lists.isEmpty(todayTasks)}">
          <td colspan="5" style="padding:40px;text-align:center;color:#666;font-size:1.2rem;">
            No tasks for today! Enjoy your free time!
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

</body>
</html>